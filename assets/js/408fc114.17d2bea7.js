"use strict";(self.webpackChunkedc_docs=self.webpackChunkedc_docs||[]).push([[2874],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,b=p["".concat(c,".").concat(m)]||p[m]||d[m]||a;return n?o.createElement(b,i(i({ref:t},u),{},{components:n})):o.createElement(b,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},76135:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const a={},i="JaCoCo with SonarQube",s={unversionedId:"submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube",id:"submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube",title:"JaCoCo with SonarQube",description:"SonarQube is a platform for both static code analysis and test code coverage analysis. It offers an open source Community",source:"@site/docs/submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube.md",sourceDirName:"submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage",slug:"/submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube",permalink:"/edc-docs/docs/submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube",draft:!1,editUrl:"https://github.com/FraunhoferISST/edc-docs/tree/master/docs/submodule/Connector/docs/developer/decision-records/2022-02-10-code-coverage/sonarqube.md",tags:[],version:"current",frontMatter:{}},c={},l=[{value:"Integration with Github Actions",id:"integration-with-github-actions",level:2},{value:"Limitations of the Community Edition version",id:"limitations-of-the-community-edition-version",level:2}],u={toc:l};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,o.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"jacoco-with-sonarqube"},"JaCoCo with SonarQube"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.sonarqube.org/latest/setup/get-started-2-minutes/"},"SonarQube")," is a platform for both static code analysis and test code coverage analysis. It offers an open source Community\nEdition version, which is free but has some limitations."),(0,r.kt)("p",null,"SonarQube can be run locally by adding a SonarQube plugin to gradle and e.g. running SonarQube instance from docker."),(0,r.kt)("p",null,"Add Gradle plugin:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-gradle"},'plugin {\n    id("org.sonarqube") version "3.3"\n}\n')),(0,r.kt)("p",null,"To enable code coverage reports test coverage reports should be generated (explained in sections: Option 1 and Option 2)."),(0,r.kt)("p",null,"Docker-compose file with minimal configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},'version: "3"\nservices:\n  sonarqube:\n    image: sonarqube:lts\n    ports:\n      - 9000:9000\n    environment:\n      - SONAR_FORCEAUTHENTICATION=false\n')),(0,r.kt)("p",null,"Then when sonar is up current project can be added to the analysis by running a command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./gradlew sonarqube\n")),(0,r.kt)("p",null,"Above mentioned configuration works when SonarQube is running on default url: http://localhost:9000 and jacoco reports are placed in default location.\nOtherwise these properties should be set: ",(0,r.kt)("em",{parentName:"p"},"sonar.host.url"),", ",(0,r.kt)("em",{parentName:"p"},"sonar.jacoco.reportPaths"),". Here can be found more information about ",(0,r.kt)("a",{parentName:"p",href:"https://docs.sonarqube.org/latest/analysis/scan/sonarscanner-for-gradle/"},"sonarqube Gradle plugin"),"."),(0,r.kt)("p",null,"Code coverage analysis with SonarQube:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Code Coverage with Sonar",src:n(38843).Z,width:"1627",height:"928"})),(0,r.kt)("h2",{id:"integration-with-github-actions"},"Integration with Github Actions"),(0,r.kt)("p",null,"Integration with github Actions wasn't a part of this spike, because it requires having a SonarQube instance deployed for the whole project, instead of using\nlocalhost version."),(0,r.kt)("p",null,"More information about ",(0,r.kt)("a",{parentName:"p",href:"https://docs.sonarqube.org/latest/analysis/github-integration/"},"Github Integration"),"."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/marketplace/actions/official-sonarqube-scan"},"Github Action that helps to run the code analysis.")),(0,r.kt)("h2",{id:"limitations-of-the-community-edition-version"},"Limitations of the Community Edition version"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Analysis of multiple branches is not supported"),(0,r.kt)("li",{parentName:"ul"},"Reporting measures to branches and pull requests in Github not supported"),(0,r.kt)("li",{parentName:"ul"},"Automatic detection of branches/pull requests in Github Actions not supported")))}d.isMDXComponent=!0},38843:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/code-coverage-sonar-a78ce8aebfe6c7618780e48a9e13619e.png"}}]);