"use strict";(self.webpackChunkedc_docs=self.webpackChunkedc_docs||[]).push([[2028],{3905:(e,t,i)=>{i.d(t,{Zo:()=>p,kt:()=>u});var a=i(7294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t){if(null==e)return{};var i,a,n=function(e,t){if(null==e)return{};var i,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),i=t;return e&&(i="function"==typeof e?e(t):l(l({},t),e)),i},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var i=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=c(i),u=n,h=m["".concat(s,".").concat(u)]||m[u]||d[u]||r;return i?a.createElement(h,l(l({ref:t},p),{},{components:i})):a.createElement(h,l({ref:t},p))}));function u(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=i.length,l=new Array(r);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:n,l[1]=o;for(var c=2;c<r;c++)l[c]=i[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,i)}m.displayName="MDXCreateElement"},831:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var a=i(7462),n=(i(7294),i(3905));const r={},l="Identity Hub - Get claims",o={unversionedId:"Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/README",id:"Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/README",title:"Identity Hub - Get claims",description:"This document explains how we will get the claims of a participant, in order to apply access policies.",source:"@site/docs/Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/README.md",sourceDirName:"Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims",slug:"/Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/",permalink:"/edc-docs/docs/Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/",draft:!1,editUrl:"https://github.com/FraunhoferISST/edc-docs/tree/master/docs/Components/IdentityHub/docs/developer/decision-records/2022-07-01-get-claims/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Identity Hub",permalink:"/edc-docs/docs/Components/IdentityHub/docs/developer/decision-records/2022-06-08-identity-hub/"},next:{title:"Identity Hub - Self Description",permalink:"/edc-docs/docs/Components/IdentityHub/docs/developer/decision-records/2022-07-29-self-description/"}},s={},c=[{value:"Context",id:"context",level:2},{value:"Claim",id:"claim",level:2},{value:"Credential issuer",id:"credential-issuer",level:2},{value:"Examples of policy",id:"examples-of-policy",level:2},{value:"Example 1:",id:"example-1",level:3},{value:"Example 2:",id:"example-2",level:3},{value:"Verifiable Credentials",id:"verifiable-credentials",level:2},{value:"Get claims",id:"get-claims",level:2},{value:"Claims format",id:"claims-format",level:2}],p={toc:c};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"identity-hub---get-claims"},"Identity Hub - Get claims"),(0,n.kt)("p",null,"This document explains how we will get the claims of a participant, in order to apply access policies."),(0,n.kt)("h2",{id:"context"},"Context"),(0,n.kt)("p",null,"When an EDC participant receives an IDS request, it must verify the caller's identity and apply access policies for the caller.\nTo apply policies, it needs to get the claims of the participant.\nThis document explains the mechanism to get the claims from IdentityHub."),(0,n.kt)("h2",{id:"claim"},"Claim"),(0,n.kt)("p",null,"A claim is a statement about a subject. For example, a claim could be ",(0,n.kt)("inlineCode",{parentName:"p"},"ParticipantA")," is in ",(0,n.kt)("inlineCode",{parentName:"p"},"region")," ",(0,n.kt)("inlineCode",{parentName:"p"},"eu"),".\nSee ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#claims"},"this documentation")," for more details."),(0,n.kt)("h2",{id:"credential-issuer"},"Credential issuer"),(0,n.kt)("p",null,"A credential issuer is an entity providing claims about a subject and signing it.\nSigning the claim is valuable to make sure the claim is delivered by a trusted entity."),(0,n.kt)("h2",{id:"examples-of-policy"},"Examples of policy"),(0,n.kt)("p",null,"In order to apply policy we need to get the claims and verify the issuer of the claim."),(0,n.kt)("h3",{id:"example-1"},"Example 1:"),(0,n.kt)("p",null,"Policy requiring that ",(0,n.kt)("inlineCode",{parentName:"p"},"Government A")," certifies that ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A")," has ",(0,n.kt)("inlineCode",{parentName:"p"},"region")," ",(0,n.kt)("inlineCode",{parentName:"p"},"eu"),".\nIn this example, ",(0,n.kt)("inlineCode",{parentName:"p"},"Government A")," is the credential issuer, and the claim is: ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A")," has ",(0,n.kt)("inlineCode",{parentName:"p"},"region")," ",(0,n.kt)("inlineCode",{parentName:"p"},"eu"),"."),(0,n.kt)("h3",{id:"example-2"},"Example 2:"),(0,n.kt)("p",null,"Policy requiring that ",(0,n.kt)("inlineCode",{parentName:"p"},"Organization A")," certifies that ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A")," has ",(0,n.kt)("inlineCode",{parentName:"p"},"certification")," ",(0,n.kt)("inlineCode",{parentName:"p"},"ISO 9001"),".\nIn this example, ",(0,n.kt)("inlineCode",{parentName:"p"},"Organization A")," is the credential issuer, and the claim would be ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A")," has ",(0,n.kt)("inlineCode",{parentName:"p"},"certification")," ",(0,n.kt)("inlineCode",{parentName:"p"},"ISO 9001"),"."),(0,n.kt)("h2",{id:"verifiable-credentials"},"Verifiable Credentials"),(0,n.kt)("p",null,"IdentityHub provides ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#claims"},"claims")," as JWS, signed by a credential issuer, effectively making them verifiable credentials.  "),(0,n.kt)("h2",{id:"get-claims"},"Get claims"),(0,n.kt)("p",null,"This document focuses on getting the claims of a Participant, assuming the participant's identity is already verified.\nThe participant will use the claims to apply the access policy.",(0,n.kt)("br",{parentName:"p"}),"\n","Each participant has an IdentityHub instance, exposing an endpoint to get its ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/"},"Verifiable Credentials"),".\nThe IdentityHub endpoint returns a list of JWS containing a Verifiable Credential in their payload.\n(see ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#example-usage-of-the-credentialsubject-property"},"example Verifiable Credential (as JWT)"),").\nThe VerifiableCredentials contain ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#claims"},"claims")," that can be extracted."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Apply policy flow",src:i(4394).Z,width:"847",height:"717"})),(0,n.kt)("p",null,"Let's focus on the ",(0,n.kt)("inlineCode",{parentName:"p"},"Get claims")," box.\n",(0,n.kt)("inlineCode",{parentName:"p"},"Participant B")," wants to get the claims of ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A"),", to apply access policy.\nFor example, ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant B")," could have the policy that ",(0,n.kt)("inlineCode",{parentName:"p"},"Participant A")," should be claimed as a ",(0,n.kt)("inlineCode",{parentName:"p"},"participantOf"),"\n",(0,n.kt)("inlineCode",{parentName:"p"},"Dataspace C"),' by the issuer "gaia-x.com".'),(0,n.kt)("ol",{start:5},(0,n.kt)("li",{parentName:"ol"},"Participant B extracts the IdentityHub URL of participant A from a DID Document obtained in previous steps."),(0,n.kt)("li",{parentName:"ol"},"Participant B gets VerifiableCredentials from IdentityHub A."),(0,n.kt)("li",{parentName:"ol"},"Participant B gets a list of ",(0,n.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#claims"},"claims")," as JWS, signed by a third party, effectively making them ",(0,n.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model"},"VerifiableCredentials"),".",(0,n.kt)("br",{parentName:"li"}),"For each VerifiableCredential:",(0,n.kt)("br",{parentName:"li"}),"8. Participant B parses the JWS, extracts the issuer DID URL from the JWS payload.",(0,n.kt)("br",{parentName:"li"}),"9. Participant B retrieves the issuer DID Document.",(0,n.kt)("br",{parentName:"li"}),"10. From the issuer DID Document, participant B extracts the public key of the issuer and uses it to verify the JWS signature.",(0,n.kt)("br",{parentName:"li"}),"11. If the signature is successfully verified, it extracts the claims of the participant, each claim needs to be associated with its issuer.  "),(0,n.kt)("li",{parentName:"ol"},"The list of the claims will be used as input to apply the access policies.")),(0,n.kt)("h2",{id:"claims-format"},"Claims format"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"IdentityHubCredentialsVerifier")," returns a ",(0,n.kt)("inlineCode",{parentName:"p"},"Map<String, Object>"),", which contains verifiable credentials with the following format:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'"<verifiable-credential-id>": {\n  "vc": {\n    "id": "<verifiable-credential-id>",\n    "credentialSubject": "<claims>"\n  }\n  "iss": "<issuer did>, (part of the JWT claims)"\n  "sub": "<subject>, (part of the JWT claims)"\n}\n')),(0,n.kt)("p",null,"The credentialSubject field can contain claims with various format, see the ",(0,n.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#credential-subject"},"Credential Subject documentation")," for more details."),(0,n.kt)("p",null,"For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "vc_id_1": {\n    "vc": {\n      "id": "vc_id_1",\n      "credentialSubject": {\n        "region": "eu"\n      }, \n       "iss": "did:web:issuer1",\n       "sub": "did:web:subjectA"\n    }\n  },\n  "vc_id_2": {\n     "vc": {\n        "id": "vc_id_2",\n        "credentialSubject": {\n           "region": "eu"\n        },\n        "iss": "did:web:issuer2",\n        "sub": "did:web:subjectA"\n     }\n  }\n}\n')))}d.isMDXComponent=!0},4394:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/apply-policies-flow-2ad3a94de679f3cc02b9c7a392da4e95.png"}}]);